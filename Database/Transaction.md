# 트랜잭션(Transaction)

- 데이터베이스 내에서 한꺼번에 모두 수행되어야 할 연산들의 집합, 하나의 작업 처리를 위한 논리적 작업 단위
- 트랜잭션 내의 연산은 한꺼번에 완료되어야 하며 그렇지 못한 경우 모두 취소되어야한다.

### 1. 트랜잭션의 성질

- #### 원자성(Atomicity)

  - 트랜잭션의 가장 기본적인 특성, 반드시 수행되거나 반드시 수행되지 않아야 함

- #### 일관성(Consistency)

  - 트랜잭션이 정상적으로 완료된 후 언제나 일관성 있는 데이터베이스 상태가 되어야 하며, 결과에 모순이 생겨서는 안 됨

- #### 격리성(Isolation)

  - 독립성, 하나의 트랜잭션이 수행 중에는 다른 트랜잭션이 접근할 수 없고 각각의 트랜잭션은 독립적이어야 함

- #### 영속성(Durability)

  - 지속성, 트랜잭션이 성공적으로 완료된 후 결과는 지속적으로 유지되어야 함

<br />

### 2. 트랜잭션 연산

#### 1) COMMIT

- 트랜잭션이 성공적으로 종료된 후 수정된 내용을 지속적으로 유지하기 위한 연산

#### 2) ROLLBACK

- 비정상적으로 수행되었거나 오류가 발생했을 때 수행 작업을 취소하고 이전 상태로 되돌리기 위한 연산

<br />

### 3. 트랜잭션 병행의 문제점

- #### 갱신 분실(Lost Update)

  - 두 개 이상의 트랜잭션이 수행되는 과정에서 연산 결과의 일부가 없어지는 현상

- #### 모순성(Inconsistency)

  - 두 개 이상의 트랜잭션이 수행되어 얻어진 결과 일관성 없이 서로 다른 현상

- #### 연쇄 복귀(Cascading Rollback)

  - 두 개 이상의 트랜잭션이 수행되던 중 하나의 트랜잭션이 취소되므로 인해 연쇄적으로 다른 트랜잭션도 취소되는 현상

- #### 비완료 의존성(Uncommittes Dependency)

  - 하나의 트랜잭션 수행이 실패한 후 회복되기 이전에 다른 트랜잭션이 실패한 갱신 결과를 참조하는 현상

<br />

### 4. 트랜잭션 스케줄

- 동시에 여러 개의 트랜잭션들이 병행 실행되는 경우 트랜잭션의 연산들이 실행되는 순서를 말하는 것

#### 1) 직렬 스케줄(Serial Schedule)

- 각 트랜잭션별로 구분하여 한 트랜잭션을 구성하는 연산들을 연속적으로 모두 실행하고 다른 트랜잭션을 수행하는 방식의 스케줄 기법
- T1(t1->t2->t3) -> T2(t1->t2->t3)

#### 2) 비직렬 스케줄(Nonserial Schedule)

- 트랜잭션들을 병행하여 수행하는 방법, 인터리브 실행 기법을 이용하여 각 트랜잭션의 연산들을 번갈아가면서 실행하는 방법
- T1(t1) -> T2(t1) -> T1(t2) -> T2(t2) -> T1(t3) -> T2(t3)

<br />

#### 생각해보기!

- ##### 트랜잭션이 무엇인가요? 예시를 들어설명해주세요

  - 트랜잭션이란 작업의 단위로 한 작업이 온전히 수행되거나 그렇지 않았을 때의 정보를 모순되지 않도록 합니다. 예를 들어 어떤 서비스에 가입을 하면 고객이 3000원 쿠폰을 받는다고 했을 때, 이 작업 전체를 트랜잭션으로 처리한다면 중간에 오류가 발생한다고 하더라도 고객이 가입을 했는데 쿠폰을 받지 못하는 등의 모순적인 결과는 나오지 않습니다.

- ##### 트랜잭션은 어떤 성질을 가지고 있나요?

  - 먼저 원자성(Atomicity)으로, 작업이 반드시 수행되거나 반드시 수행되지 않는 성질입니다. 다음은 일관성(Consistency)으로, 트랜잭션이 정상적으로 완료된 후 언제나 일관성 있는 데이터베이스 상태가 되어야 합니다. 독립성(Isolation)은 하나의 트랜잭션이 수행 중에는 다른 트랜잭션이 접근할 수 없고 각각의 트랜잭션은 독립적이어야 한다는 성질입니다. 마지막으로 영속성(Durability)은 트랜잭션이 성공적으로 완료된 후 결과는 지속적으로 유지되는 성질입니다.
  
- ##### 여러개의 트랜잭션이 한 테이블을 대상으로 진행한 경우의 문제점이 무엇인가요?

  - 트랜잭션을 병행으로 처리될 때는 갱신 내용 손실, 비완료 의존성, 모순성, 연쇄복귀의 문제점이 발생할 수 있습니다.

